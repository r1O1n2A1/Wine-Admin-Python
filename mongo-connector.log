2017-05-11 09:28:18,754 [ALWAYS] mongo_connector.connector:51 - Starting mongo-connector version: 2.5.1
2017-05-11 09:28:18,754 [ALWAYS] mongo_connector.connector:51 - Python version: 2.7.12 (default, Nov 19 2016, 06:48:10) 
[GCC 5.4.0 20160609]
2017-05-11 09:28:18,754 [ALWAYS] mongo_connector.connector:51 - Platform: Linux-4.4.0-75-generic-x86_64-with-Ubuntu-16.04-xenial
2017-05-11 09:28:18,755 [ALWAYS] mongo_connector.connector:51 - pymongo version: 3.4.0
2017-05-11 09:28:18,755 [WARNING] mongo_connector.connector:167 - MongoConnector: Can't find /home/ronan/Project1AL/Wine-Admin-Python/oplog.timestamp, attempting to create an empty progress log
2017-05-11 09:28:18,762 [ALWAYS] mongo_connector.connector:51 - Source MongoDB version: 3.4.3
2017-05-11 09:28:18,763 [ALWAYS] mongo_connector.connector:51 - Target DocManager: mongo_connector.doc_managers.elastic2_doc_manager version: 0.3.0
2017-05-11 09:33:41,537 [ERROR] mongo_connector.oplog_manager:320 - Cursor closed due to an exception. Will attempt to reconnect.
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/mongo_connector/oplog_manager.py", line 221, in run
    for n, entry in enumerate(cursor):
  File "/usr/local/lib/python2.7/dist-packages/pymongo/cursor.py", line 1114, in next
    if len(self.__data) or self._refresh():
  File "/usr/local/lib/python2.7/dist-packages/pymongo/cursor.py", line 1056, in _refresh
    self.__max_await_time_ms))
  File "/usr/local/lib/python2.7/dist-packages/pymongo/cursor.py", line 873, in __send_message
    **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/pymongo/mongo_client.py", line 905, in _send_message_with_response
    exhaust)
  File "/usr/local/lib/python2.7/dist-packages/pymongo/mongo_client.py", line 916, in _reset_on_error
    return func(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/pymongo/server.py", line 136, in send_message_with_response
    response_data = sock_info.receive_message(1, request_id)
  File "/usr/local/lib/python2.7/dist-packages/pymongo/pool.py", line 452, in receive_message
    self._raise_connection_failure(error)
  File "/usr/local/lib/python2.7/dist-packages/pymongo/pool.py", line 552, in _raise_connection_failure
    raise error
AutoReconnect: connection closed
2017-05-11 09:40:33,235 [WARNING] elasticsearch:88 - PUT /db_wine_admin/_mapping/admin [status:404 request:0.001s]
2017-05-11 09:40:33,235 [ERROR] mongo_connector.oplog_manager:288 - Unable to process oplog document {u'h': -7193490146608320276L, u'ts': Timestamp(1494488433, 1), u'o': {u'create': u'admin', u'autoIndexId': True, u'idIndex': {u'ns': u'db_wine_admin.admin', u'name': u'_id_', u'key': {u'_id': 1}, u'v': 2}}, u't': 8L, u'v': 2, u'ns': u'db_wine_admin.$cmd', u'op': u'c'}
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/mongo_connector/oplog_manager.py", line 283, in run
    timestamp)
  File "/usr/local/lib/python2.7/dist-packages/mongo_connector/util.py", line 46, in wrapped
    reraise(new_type, exc_value, exc_tb)
  File "/usr/local/lib/python2.7/dist-packages/mongo_connector/util.py", line 35, in wrapped
    return f(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/mongo_connector/doc_managers/elastic2_doc_manager.py", line 246, in handle_command
    "_source": {"enabled": True}
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/client/utils.py", line 69, in _wrapped
    return func(*args, params=params, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/client/indices.py", line 283, in put_mapping
    '_mapping', doc_type), params=params, body=body)
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/transport.py", line 327, in perform_request
    status, headers, data = connection.perform_request(method, url, params, body, ignore=ignore, timeout=timeout)
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/http_urllib3.py", line 110, in perform_request
    self._raise_error(response.status, raw_data)
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/base.py", line 114, in _raise_error
    raise HTTP_EXCEPTIONS.get(status_code, TransportError)(status_code, error_message, additional_info)
OperationFailed: TransportError(404, u'index_not_found_exception', u'no such index')
2017-05-11 09:40:49,836 [ERROR] mongo_connector.doc_managers.elastic2_doc_manager:491 - Bulk request failed with exception
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/mongo_connector/doc_managers/elastic2_doc_manager.py", line 484, in send_buffered_operations
    successes, errors = bulk(self.elastic, action_buffer)
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/helpers/__init__.py", line 190, in bulk
    for ok, item in streaming_bulk(client, actions, **kwargs):
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/helpers/__init__.py", line 162, in streaming_bulk
    for result in _process_bulk_chunk(client, bulk_actions, raise_on_exception, raise_on_error, **kwargs):
  File "/usr/local/lib/python2.7/dist-packages/elasticsearch/helpers/__init__.py", line 134, in _process_bulk_chunk
    raise BulkIndexError('%i document(s) failed to index.' % len(errors), errors)
BulkIndexError: (u'39 document(s) failed to index.', [{u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1c8', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1c9', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1ca', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1cb', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1cc', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1cd', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1ce', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1cf', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d0', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d1', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d2', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d3', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d4', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d5', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d6', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_millesime] of different type, current_type [string], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d7', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d8', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1d9', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1da', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1db', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1dc', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1de', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1df', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1e0', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1e1', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1e2', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1e3', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1e6', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1e9', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1eb', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1ed', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1f1', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_millesime] of different type, current_type [string], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1f5', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1fa', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914157f57ccd6332a7ca1fd', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914158057ccd6332a7ca209', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914158057ccd6332a7ca20b', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914158057ccd6332a7ca21a', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [double], merged_type [long]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}, {u'index': {u'status': 400, u'_type': u'user', u'_id': u'5914158057ccd6332a7ca21e', u'error': {u'caused_by': {u'reason': u'mapper [user.order.product.product_price] of different type, current_type [long], merged_type [double]', u'type': u'illegal_argument_exception'}, u'reason': u'failed to parse', u'type': u'mapper_parsing_exception'}, u'_index': u'db_wine_admin'}}])
